<div class="shift-250">
<div class="fade-bg">
<div class="div-one">
  <!-- Profile Header -->
    <!-- Profile Picture Column -->
    <div class="col-12 col-md-4 text-center profile-pic">
      <div class="rounded-circle  text-white d-flex align-items-center justify-content-center mx-auto" style="width: 150px; height: 150px;">
        <!-- If you have avatar, replace this with image tag -->
        <%#= cl_image_tag  %>
        <img class="profile-img" src="https://cdn-icons-png.flaticon.com/512/6858/6858485.png">
        <i class="bi bi-person" style="font-size: 4rem;"></i>
      </div>
    </div>
    </div>

  <div class="div-two">
    <!-- Profile Info Column -->
    <div class="profile-name-follow-unfollow">
      <div class="mt-3" data-controller="follow" data-user-id="<%= @user.id %>">
      <!-- Username and Edit Profile Button Row -->
      <div class="d-flex align-items-center mb-3 profile-name-follow">
        <div class="profile-name">
          <h4 class=""><%= "@#{@user.username}" %></h4>
        </div>
        <div class="profile-follow">
          <% if current_user == @user %>
            <%= link_to 'Edit Profile', edit_profile_path(@user), class: 'btn btn-outline-secondary px-4 profile-info-colu' %>
          <% else %>
          <!-- follow and unfollow -->
            <div id="follow-unfollow-container">
              <% if current_user.following.include?(@user) %>
                <button class="btn btn-outline-dark px-4" data-action="click->follow#unfollow" data-follow-target="button">
                  Following
                </button>
              <% else %>
                <button class="btn px-5" data-action="click->follow#follow" data-follow-target="button">
                  Follow
                </button>
              <% end %>
            </div>
          <% end %>

          <%= button_to "Start Chat", create_chat_path(recipient_id: @user.id), method: :post, class: "btn btn-primary start-chat profile-info-colu" %>
          <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "btn btn-outline-danger ms-2 profile-info-colu" %>
        </div>
        </div>
      </div>
      </div>

      <!-- Stats Row -->
      <div class="d-flex mb-3">
        <div class="me-4">
          <strong><%= @user.posts.count %></strong> posts
        </div>
        <!-- followers -->
        <div class="me-4">
          <%= link_to followers_profile_path(@user), class: "text-decoration-none" do %>
          <strong data-follow-target="county"><%= @user.followers.count %></strong> followers
          <% end %>
        </div>
        <!-- followering -->
        <div class="me-4">
          <%= link_to following_profile_path(@user), class: "text-decoration-none" do %>
            <strong><%= @user.following.count %></strong> following
          <% end %>
        </div>
      </div>

      <!-- Bio -->
      <div class="">
        <% if @user.bio.present? %>
          <p class="p-smaller p-margin"><%= @user.bio %></p>
        <% else %>
          <p class="text-muted mb-0 p-margin">No bio available.</p>
        <% end %>
      </div>

      <!-- Interests -->
      <div class="">
        <p class="mb-1 p-smaller p-faded">Interests</p>
        <% if @user.interests.any? %>
          <div class="d-flex flex-wrap gap-2">
            <% @user.interests.each do |interest| %>
              <%= link_to interest_path(interest), class: "text-decoration-none" do %>
                <span class="badge blue-bkg text-light">
                  <%= "##{interest.title}" %>
                </span>
              <% end %>
            <% end %>
          </div>
        <% else %>
          <p class="text-muted small">No interests added yet</p>
        <% end %>
      </div>
  </div>

  </div>

  <!-- Posts Grid -->
  <div class="container">
  <div class="row border-top pt-4">
    <% if @user.posts.any? %>
      <% @user.posts.each do |post| %>
        <div class="col-12 col-md-4 redoing-padding">
          <div class="card h-100">
            <div class="bg-light d-flex align-items-center justify-content-center" style="height: 300px; position: relative;">
             <% if post.photo.attached? %>
            <%= cl_image_tag post.photo.key, height: 300, width: 400, crop: :fill, class: "constrain-image"  %>
          <% else %>
            <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 300px;">
              <p class="text-muted">No media available unfortunately my guy</p>
            </div>
          <% end %>
              <!--<img src="<%#= post.media_url %>" class="card-img-top" style="object-fit: cover; height: 100%; width: 100%; position: absolute; top: 0; left: 0;" alt="Post Image">-->
              <i class="bi bi-image text-secondary" style="font-size: 2rem;"></i>
            </div>
            <div class="card-body card-boddy-padding">
              <!--<p class="card-text"><%#= post.content.truncate(50) %></p>-->
<!--              <small class="text-muted">-->
                <%#= post.created_at.strftime("%B %d, %Y") %>
<!--              </small>
              <div class="mt-2">
                <span class="badge bg-primary"><%#= post.likes.count %> Likes</span>
              </div>-->
              <%#= link_to '', post, class: 'stretched-link' %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="col-12 text-center py-5">
        <i class="bi bi-camera text-secondary mb-3" style="font-size: 3rem;"></i>
        <h5 class="text-secondary">No Posts Yet</h5>
      </div>
    <% end %>
  </div>
</div>
</div>
