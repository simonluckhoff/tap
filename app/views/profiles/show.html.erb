<div class="container-fluid mt-4">
  <!-- Profile Header -->
  <div class="row mb-5">
    <!-- Profile Picture Column -->
    <div class="col-12 col-md-4 text-center">
      <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center mx-auto" style="width: 150px; height: 150px;">
        <!-- If you have avatar, replace this with image tag -->
        <%#= cl_image_tag  %>
        <img src="https://cdn-icons-png.flaticon.com/512/6858/6858485.png" style="width: 150px; height: 150px;">
        <i class="bi bi-person" style="font-size: 4rem;"></i>
      </div>
    </div>

    <!-- Profile Info Column -->
    <div class="col-12 col-md-8 mt-3">
      <!-- Username and Edit Profile Button Row -->
      <div class="d-flex align-items-center mb-3">
        <% if current_user == @user %>
          <%= link_to 'Edit Profile', edit_profile_path(@user), class: 'btn btn-outline-secondary px-4' %>
        <% else %>
          <div id="follow-unfollow-container" data-controller="follow" data-user-id="<%= @user.id %>">
            <% if current_user.following.include?(@user) %>
              <button class="btn btn-outline-dark px-4" data-action="click->follow#unfollow" data-follow-target="button">
                Following
              </button>
            <% else %>
              <button class="btn px-5" data-action="click->follow#follow" data-follow-target="button">
                Follow
              </button>
            <% end %>
          </div>
        <% end %>

        <%= button_to "Start Chat", create_chat_path(recipient_id: @user.id), method: :post, class: "btn btn-primary" %>

      </div>

      <!-- Stats Row -->
      <div class="d-flex mb-3">
        <div class="me-4">
          <strong><%= @user.posts.count %></strong> posts
        </div>
        <div class="me-4">
          <%= link_to followers_follows_path, class: "text-decoration-none" do %>
          <strong><%= @user.followers.count %></strong> followers
          <% end %>
        </div>
        <div class="me-4">
          <%= link_to following_follows_path, class: "text-decoration-none" do %>
            <strong><%= @user.following.count %></strong> following
          <% end %>
        </div>
      </div>

      <!-- Bio -->
      <h2 class="mb-0 me-5"><%= @user.username %></h2>
      <div class="mb-3">
        <% if @user.bio.present? %>
          <p class="mb-0"><%= @user.bio %></p>
        <% else %>
          <p class="text-muted mb-0">No bio available.</p>
        <% end %>
      </div>

      <!-- Interests -->
      <div class="mt-3">
        <h6 class="mb-2">Interests</h6>
        <% if @user.interests.any? %>
          <div class="d-flex flex-wrap gap-2">
            <% @user.interests.each do |interest| %>
              <%= link_to interest_path(interest), class: "text-decoration-none" do %>
                <span class="badge bg-light text-dark border">
                  <%= interest.title %>
                </span>
              <% end %>
            <% end %>
          </div>
        <% else %>
          <p class="text-muted small">No interests added yet</p>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Posts Grid -->
  <div class="row border-top pt-4">
    <% if @user.posts.any? %>
      <% @user.posts.each do |post| %>
        <div class="col-12 col-md-4 mb-4">
          <div class="card h-100">
            <div class="bg-light d-flex align-items-center justify-content-center" style="height: 300px; position: relative;">
              <!--<img src="<%#= post.media_url %>" class="card-img-top" style="object-fit: cover; height: 100%; width: 100%; position: absolute; top: 0; left: 0;" alt="Post Image">-->
              <i class="bi bi-image text-secondary" style="font-size: 2rem;"></i>
            </div>
            <div class="card-body">
              <!--<p class="card-text"><%#= post.content.truncate(50) %></p>-->
              <small class="text-muted">
                <%= post.created_at.strftime("%B %d, %Y") %>
              </small>
              <div class="mt-2">
                <span class="badge bg-primary"><%= post.likes.count %> Likes</span>
              </div>
              <%= link_to '', post, class: 'stretched-link' %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="col-12 text-center py-5">
        <i class="bi bi-camera text-secondary mb-3" style="font-size: 3rem;"></i>
        <h5 class="text-secondary">No Posts Yet</h5>
      </div>
    <% end %>
  </div>
</div>
